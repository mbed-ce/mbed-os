<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mbed OS Reference: CacheAlignedBuffer&lt; DataT &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mbed-ce_55x55.png"/></td>
  <td id="projectalign">
   <div id="projectname">Mbed OS Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classmbed_1_1_cache_aligned_buffer.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle"><div class="title">CacheAlignedBuffer&lt; DataT &gt; Class Template Reference<div class="ingroups"><a class="el" href="group__mbed-os-public.html">Public API</a> &raquo; <a class="el" href="group__platform-public-api.html">Platform</a> &raquo; <a class="el" href="group__platform___cache_aligned_buffer.html">CacheAlignedBuffer class</a></div></div></div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classmbed_1_1_cache_aligned_buffer.html" title="CacheAlignedBuffer is used by Mbed in locations where we need a cache-aligned buffer.">CacheAlignedBuffer</a> is used by Mbed in locations where we need a cache-aligned buffer.  
 <a href="classmbed_1_1_cache_aligned_buffer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_cache_aligned_buffer_8h_source.html">CacheAlignedBuffer.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CacheAlignedBuffer&lt; DataT &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classmbed_1_1_cache_aligned_buffer.png" usemap="#CacheAlignedBuffer_3C_20DataT_20_3E_map" alt=""/>
  <map id="CacheAlignedBuffer_3C_20DataT_20_3E_map" name="CacheAlignedBuffer_3C_20DataT_20_3E_map">
<area href="classmbed_1_1_static_cache_aligned_buffer.html" alt="StaticCacheAlignedBuffer&lt; uint8_t, _block_size &gt;" shape="rect" coords="0,56,294,80"/>
<area href="classmbed_1_1_dynamic_cache_aligned_buffer.html" title="CacheAlignedBuffer type which allocates its backing buffer on the heap." alt="DynamicCacheAlignedBuffer&lt; DataT &gt;" shape="rect" coords="304,56,598,80"/>
<area href="classmbed_1_1_static_cache_aligned_buffer.html" title="CacheAlignedBuffer type designed for static allocation." alt="StaticCacheAlignedBuffer&lt; DataT, BufferSize &gt;" shape="rect" coords="608,56,902,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ga77d1bb3ceb06603720aa2fe0f08bd766" id="r_ga77d1bb3ceb06603720aa2fe0f08bd766"><td class="memItemLeft" align="right" valign="top">DataT *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__platform-public-api.html#ga77d1bb3ceb06603720aa2fe0f08bd766">data</a> ()</td></tr>
<tr class="memdesc:ga77d1bb3ceb06603720aa2fe0f08bd766"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a pointer to the aligned data array inside the buffer.  <br /></td></tr>
<tr class="separator:ga77d1bb3ceb06603720aa2fe0f08bd766"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafbbed032fa6977d89152f06352a6acaa" id="r_gafbbed032fa6977d89152f06352a6acaa"><td class="memItemLeft" align="right" valign="top">DataT const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__platform-public-api.html#gafbbed032fa6977d89152f06352a6acaa">data</a> () const</td></tr>
<tr class="memdesc:gafbbed032fa6977d89152f06352a6acaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a pointer to the aligned data array inside the buffer (const version)  <br /></td></tr>
<tr class="separator:gafbbed032fa6977d89152f06352a6acaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9d939cb95bad4e3b0a80709856ade552" id="r_ga9d939cb95bad4e3b0a80709856ade552"><td class="memItemLeft" align="right" valign="top">DataT &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__platform-public-api.html#ga9d939cb95bad4e3b0a80709856ade552">operator[]</a> (size_t index)</td></tr>
<tr class="memdesc:ga9d939cb95bad4e3b0a80709856ade552"><td class="mdescLeft">&#160;</td><td class="mdescRight">Element access.  <br /></td></tr>
<tr class="separator:ga9d939cb95bad4e3b0a80709856ade552"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8156285d08258155492aa68eb97e22a3" id="r_ga8156285d08258155492aa68eb97e22a3"><td class="memItemLeft" align="right" valign="top">DataT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__platform-public-api.html#ga8156285d08258155492aa68eb97e22a3">operator[]</a> (size_t index) const</td></tr>
<tr class="memdesc:ga8156285d08258155492aa68eb97e22a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Element access (const)  <br /></td></tr>
<tr class="separator:ga8156285d08258155492aa68eb97e22a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad69bd11391be1a1dba5c8202259664f8" id="r_gad69bd11391be1a1dba5c8202259664f8"><td class="memItemLeft" align="right" valign="top">iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__platform-public-api.html#gad69bd11391be1a1dba5c8202259664f8">begin</a> ()</td></tr>
<tr class="memdesc:gad69bd11391be1a1dba5c8202259664f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get iterator for start of buffer.  <br /></td></tr>
<tr class="separator:gad69bd11391be1a1dba5c8202259664f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga29305669b60ca1680752e2fc3592ba99" id="r_ga29305669b60ca1680752e2fc3592ba99"><td class="memItemLeft" align="right" valign="top">const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__platform-public-api.html#ga29305669b60ca1680752e2fc3592ba99">begin</a> () const</td></tr>
<tr class="memdesc:ga29305669b60ca1680752e2fc3592ba99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get iterator for start of buffer.  <br /></td></tr>
<tr class="separator:ga29305669b60ca1680752e2fc3592ba99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacad38d52497a975bfb6f2f6acd76631f" id="r_gacad38d52497a975bfb6f2f6acd76631f"><td class="memItemLeft" align="right" valign="top">iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__platform-public-api.html#gacad38d52497a975bfb6f2f6acd76631f">end</a> ()</td></tr>
<tr class="memdesc:gacad38d52497a975bfb6f2f6acd76631f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get iterator for end of buffer.  <br /></td></tr>
<tr class="separator:gacad38d52497a975bfb6f2f6acd76631f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaccf9a4bd0c34d4a5f6a7dab66ea10cdc" id="r_gaccf9a4bd0c34d4a5f6a7dab66ea10cdc"><td class="memItemLeft" align="right" valign="top">const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__platform-public-api.html#gaccf9a4bd0c34d4a5f6a7dab66ea10cdc">end</a> () const</td></tr>
<tr class="memdesc:gaccf9a4bd0c34d4a5f6a7dab66ea10cdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get iterator for end of buffer.  <br /></td></tr>
<tr class="separator:gaccf9a4bd0c34d4a5f6a7dab66ea10cdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad977c95bfa803d0fe31719db7a8a3f31" id="r_gad977c95bfa803d0fe31719db7a8a3f31"><td class="memItemLeft" align="right" valign="top">constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__platform-public-api.html#gad977c95bfa803d0fe31719db7a8a3f31">capacity</a> ()</td></tr>
<tr class="separator:gad977c95bfa803d0fe31719db7a8a3f31"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-methods" name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:gaad7fa4fc95eef470cb78042ee4cca1c3" id="r_gaad7fa4fc95eef470cb78042ee4cca1c3"><td class="memItemLeft" align="right" valign="top">static DataT *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__platform-public-api.html#gaad7fa4fc95eef470cb78042ee4cca1c3">findCacheLineStart</a> (uint8_t *buffer)</td></tr>
<tr class="memdesc:gaad7fa4fc95eef470cb78042ee4cca1c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find and return the first location in the given buffer that starts on a cache line.  <br /></td></tr>
<tr class="separator:gaad7fa4fc95eef470cb78042ee4cca1c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:gae67bf5116be1118705777c9fe5907d16" id="r_gae67bf5116be1118705777c9fe5907d16"><td class="memItemLeft" align="right" valign="top">DataT *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__platform-public-api.html#gae67bf5116be1118705777c9fe5907d16">_alignedBufferPtr</a></td></tr>
<tr class="memdesc:gae67bf5116be1118705777c9fe5907d16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the aligned buffer. Must be set in each constructor of each subclass.  <br /></td></tr>
<tr class="separator:gae67bf5116be1118705777c9fe5907d16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad44d905112ff4b45bf344f339adf6b97" id="r_gad44d905112ff4b45bf344f339adf6b97"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__platform-public-api.html#gad44d905112ff4b45bf344f339adf6b97">_alignedBufferCapacity</a></td></tr>
<tr class="memdesc:gad44d905112ff4b45bf344f339adf6b97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Capacity of the aligned buffer, in terms of number of DataT elements.  <br /></td></tr>
<tr class="separator:gad44d905112ff4b45bf344f339adf6b97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename DataT&gt;<br />
class mbed::CacheAlignedBuffer&lt; DataT &gt;</div><p><a class="el" href="classmbed_1_1_cache_aligned_buffer.html" title="CacheAlignedBuffer is used by Mbed in locations where we need a cache-aligned buffer.">CacheAlignedBuffer</a> is used by Mbed in locations where we need a cache-aligned buffer. </p>
<p>Cache alignment is desirable in several different situations in embedded programming &ndash; one common use is when working with DMA or other peripherals which write their results back to main memory. After these peripherals do their work, the data will be correct in main memory, but the CPU cache might also contain a value cached from that memory which is now incorrect.</p>
<p>In order to read those results from memory without risk of getting old data from the CPU cache, one needs to align the buffer so it takes up an integer number of cache lines, then invalidate the cache lines so that the data gets reread from RAM.</p>
<p>CacheAlignedBuffer provides an easy way to allocate the correct amount of space so that a buffer of any size can be made cache-aligned. To instantiate a CacheAlignedBuffer, create one of its subtypes, <a class="el" href="classmbed_1_1_static_cache_aligned_buffer.html" title="CacheAlignedBuffer type designed for static allocation.">StaticCacheAlignedBuffer</a> or <a class="el" href="classmbed_1_1_dynamic_cache_aligned_buffer.html" title="CacheAlignedBuffer type which allocates its backing buffer on the heap.">DynamicCacheAlignedBuffer</a>.</p>
<h2>Converting Code to use <a class="el" href="classmbed_1_1_cache_aligned_buffer.html" title="CacheAlignedBuffer is used by Mbed in locations where we need a cache-aligned buffer.">CacheAlignedBuffer</a> </h2>
<p>For code using static arrays, like this: </p><div class="fragment"><div class="line">uint8_t rxBuffer[16];</div>
<div class="line">spi.transfer_and_wait(<span class="keyword">nullptr</span>, 0, rxBuffer, 16);</div>
</div><!-- fragment --><p> Use a <a class="el" href="classmbed_1_1_static_cache_aligned_buffer.html" title="CacheAlignedBuffer type designed for static allocation.">StaticCacheAlignedBuffer</a>: </p><div class="fragment"><div class="line"><a class="code hl_class" href="classmbed_1_1_static_cache_aligned_buffer.html">StaticCacheAlignedBuffer&lt;uint8_t, 16&gt;</a> rxBuffer;</div>
<div class="line">spi.transfer_and_wait(<span class="keyword">nullptr</span>, 0, rxBuffer, 16);</div>
<div class="ttc" id="aclassmbed_1_1_static_cache_aligned_buffer_html"><div class="ttname"><a href="classmbed_1_1_static_cache_aligned_buffer.html">mbed::StaticCacheAlignedBuffer</a></div><div class="ttdoc">CacheAlignedBuffer type designed for static allocation.</div><div class="ttdef"><b>Definition</b> <a href="_cache_aligned_buffer_8h_source.html#l00235">CacheAlignedBuffer.h:235</a></div></div>
</div><!-- fragment --><p> For code using dynamic allocation to handle unknown buffer sizes, like: </p><div class="fragment"><div class="line">uint16_t * rxBuffer = <span class="keyword">new</span> uint16_t[bufferSize];</div>
<div class="line">spi.transfer_and_wait(<span class="keyword">nullptr</span>, 0, rxBuffer, bufferSize);</div>
<div class="line">...</div>
<div class="line">delete[] rxBuffer;</div>
</div><!-- fragment --><p> use a <a class="el" href="classmbed_1_1_dynamic_cache_aligned_buffer.html" title="CacheAlignedBuffer type which allocates its backing buffer on the heap.">DynamicCacheAlignedBuffer</a>: </p><div class="fragment"><div class="line"><a class="code hl_class" href="classmbed_1_1_dynamic_cache_aligned_buffer.html">DynamicCacheAlignedBuffer&lt;uint16_t&gt;</a> rxBuffer(bufferSize);</div>
<div class="line">spi.transfer_and_wait(<span class="keyword">nullptr</span>, 0, rxBuffer, bufferSize);</div>
<div class="ttc" id="aclassmbed_1_1_dynamic_cache_aligned_buffer_html"><div class="ttname"><a href="classmbed_1_1_dynamic_cache_aligned_buffer.html">mbed::DynamicCacheAlignedBuffer</a></div><div class="ttdoc">CacheAlignedBuffer type which allocates its backing buffer on the heap.</div><div class="ttdef"><b>Definition</b> <a href="_cache_aligned_buffer_8h_source.html#l00285">CacheAlignedBuffer.h:285</a></div></div>
</div><!-- fragment --><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">DataT</td><td>Type of the data to store in the buffer. Note: CacheAlignedBuffer is not designed for using class types as DataT, and will not call constructors. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_cache_aligned_buffer_8h_source.html#l00108">108</a> of file <a class="el" href="_cache_aligned_buffer_8h_source.html">CacheAlignedBuffer.h</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>mbed</b></li><li class="navelem"><a class="el" href="classmbed_1_1_cache_aligned_buffer.html">CacheAlignedBuffer</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
